"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e},_createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){var o="BackgroundVideo";"function"==typeof define&&define.amd?define([],t(o)):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=t(o):e[o]=t(o)}(window||module||{},function(e){var t={parallax:{effect:1.5},pauseVideoOnViewLoss:!1,preventContextMenu:!1,minimumVideoWidth:400,onBeforeReady:function(){},onReady:function(){}},o=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},i=function(){function e(o,i){_classCallCheck(this,e),this.element=document.querySelectorAll(o),this.options=_extends({},t,i),this.options.browserPrexix=this.detectBrowser(),this.shimRequestAnimationFrame(),this.options.has3d=this.detect3d();for(var n=0;n<this.element.length;n++)this.init(this.element[n],n)}return _createClass(e,[{key:"init",value:function(e,t){this.el=e,this.playEvent=this.videoReadyCallback.bind(this),this.setVideoWrap(t),this.setVideoProperties(),this.insertVideos(),this.options&&this.options.onBeforeReady()&&this.options.onBeforeReady(),this.el.readyState>3?this.videoReadyCallback():(this.el.addEventListener("canplaythrough",this.playEvent,!1),this.el.addEventListener("canplay",this.playEvent,!1)),this.options.preventContextMenu&&this.el.addEventListener("contextmenu",function(){return!1})}},{key:"videoReadyCallback",value:function(){this.el.removeEventListener("canplaythrough",this.playEvent,!1),this.el.removeEventListener("canplay",this.playEvent,!1),this.options.originalVideoW=this.el.videoWidth,this.options.originalVideoH=this.el.videoHeight,this.bindEvents(),this.requestTick(),this.options&&this.options.onReady()&&this.options.onReady()}},{key:"bindEvents",value:function(){this.ticking=!1,this.options.parallax&&window.addEventListener("scroll",this.requestTick.bind(this)),window.addEventListener("resize",this.requestTick.bind(this))}},{key:"requestTick",value:function(){this.ticking||(this.ticking=!0,window.requestAnimationFrame(this.positionObject.bind(this))),this.ticking=!1}},{key:"positionObject",value:function(){var e=window.pageYOffset,t=this.scaleObject(),o=t.xPos,i=t.yPos;i=this.options.parallax?e>=0?this.calculateYPos(i,e):this.calculateYPos(i,0):-i;var n=this.options.has3d?"translate3d("+o+"px, "+i+"px, 0)":"translate("+o+"px, "+i+"px)";this.el.style[""+this.options.browserPrexix]=n,this.el.style.transform=n}},{key:"scaleObject",value:function(){var e=window.innerWidth,t=window.innerHeight,o=e/this.options.originalVideoW,i=t/this.options.originalVideoH,n=void 0;this.options.bvVideoWrap.style.width=e+"px",this.options.bvVideoWrap.style.height=t+"px",n=o>i?o:i,n*this.options.originalVideoW<this.options.minimumVideoWidth&&(n=this.options.minimumVideoWidth/this.options.originalVideoW);var s=n*this.options.originalVideoW,a=n*this.options.originalVideoH;return this.el.style.width=s+"px",this.el.style.height=a+"px",{xPos:-parseInt((s-e)/2),yPos:parseInt(a-t)/2}}},{key:"calculateYPos",value:function(e,t){var o=parseInt(this.options.bvVideoWrap.offsetTop),i=o-t;return e=-(i/this.options.parallax.effect+e)}},{key:"setVideoWrap",value:function(e){var t=document.createElement("div");this.options.bvVideoWrapClass=this.el.className+"-wrap-"+e,o(t,"bv-video-wrap"),o(t,this.options.bvVideoWrapClass),t.style.position="relative",t.style.overflow="hidden",t.style.zIndex="10",this.el.parentNode.insertBefore(t,this.el),t.appendChild(this.el),this.options.bvVideoWrap=document.querySelector("."+this.options.bvVideoWrapClass)}},{key:"setVideoProperties",value:function(){this.el.setAttribute("preload","metadata"),this.el.setAttribute("loop","true"),this.el.setAttribute("autoplay","true"),this.el.style.position="absolute",this.el.style.zIndex="1"}},{key:"insertVideos",value:function(){for(var e=0;e<this.options.src.length;e++){var t=this.options.src[e].split("."),o=t[t.length-1];this.addSourceToVideo(this.options.src[e],"video/"+o)}}},{key:"addSourceToVideo",value:function(e,t){var o=document.createElement("source");o.src=e,o.type=t,this.el.appendChild(o)}},{key:"detectBrowser",value:function(){var e=navigator.userAgent.toLowerCase(),t=void 0;return e.indexOf("chrome")>-1||e.indexOf("safari")>-1?t="webkitTransform":e.indexOf("firefox")>-1?t="MozTransform":-1!==e.indexOf("MSIE")||e.indexOf("Trident/")>0?t="msTransform":e.indexOf("Opera")>-1&&(t="OTransform"),t}},{key:"shimRequestAnimationFrame",value:function(){for(var e=0,t=["ms","moz","webkit","o"],o=0;o<t.length&&!window.requestAnimationFrame;++o)window.requestAnimationFrame=window[t[o]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[o]+"CancelAnimationFrame"]||window[t[o]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,o){var i=(new Date).getTime(),n=Math.max(0,16-(i-e)),s=window.setTimeout(function(){t(i+n)},n);return e=i+n,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}},{key:"detect3d",value:function(){var e,t,o=document.createElement("p"),i={WebkitTransform:"-webkit-transform",OTransform:"-o-transform",MSTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(o,document.body.lastChild);for(e in i)void 0!==o.style[e]&&(o.style[e]="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)",t=window.getComputedStyle(o).getPropertyValue(i[e]));return o.parentNode.removeChild(o),void 0!==t?"none"!==t:!1}}]),e}();return i}),function(e){e.fn.scrollSnap=function(t){function o(t,o,i){if(!e("body").hasClass("lock-scroll")){var s=e(window).height();i="undefined"!=typeof i?i:"up";var a=!1;t.each(function(){(o<=e(this).offset().top&&("down"==i&&o>=e(this).offset().top-2*s/3||"up"==i&&o>=e(this).offset().top-s/3)||o>=e(this).offset().top&&("up"==i&&o<=e(this).offset().top+2*s/3||"down"==i&&o<=e(this).offset().top+s/3))&&(e("body:not( .lock-scroll )").addClass("lock-scroll"),a=e(this).offset().top)}),a!==!1&&e("html, body").animate({scrollTop:a},n.speed,function(){e("body.lock-scroll").removeClass("lock-scroll")})}}var i,n=e.extend({speed:400},t),s=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,a=this;e(window).on("scroll",function(){var e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,t="up";e>s&&(t="down"),s=e,clearTimeout(i),i=setTimeout(function(){o(a,e,t)},200)})}}(jQuery),$(function(){var e=null,t=.8;doc=$(document),parallax=$(".parallax");for(var o=0;o<parallax.length;o++)e=parallax.eq(o),e.css("background-image",'url("'+e.attr("data-img")+'")');doc.on("scroll",function(o){for(var i=0;i<parallax.length;i++)e=parallax.eq(i),e.css("background-position","0 "+-((doc.scrollTop()-e.offset().top)*t)+"px")})});